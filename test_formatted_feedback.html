<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>æ ¼å¼åŒ–åé¦ˆæµ‹è¯•</title>
	<link rel="stylesheet" href="media/main.css">
	<style>
		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			max-width: 800px;
			margin: 0 auto;
			padding: 20px;
			background: #1e1e1e;
			color: #cccccc;
		}

		.test-section {
			margin: 30px 0;
			padding: 20px;
			background: #252526;
			border-radius: 8px;
			border: 1px solid #464647;
		}
	</style>
</head>

<body>
	<h1>ğŸ§ª æ ¼å¼åŒ–åé¦ˆæµ‹è¯•</h1>

	<div class="test-section">
		<h3>æµ‹è¯• 1: å®Œæ•´åˆ†ææ•°æ®</h3>
		<div id="test1" class="feedback-markdown"></div>
	</div>

	<div class="test-section">
		<h3>æµ‹è¯• 2: æ— æ”¹è¿›å»ºè®®</h3>
		<div id="test2" class="feedback-markdown"></div>
	</div>

	<div class="test-section">
		<h3>æµ‹è¯• 3: ç©ºåé¦ˆ</h3>
		<div id="test3" class="feedback-markdown"></div>
	</div>

	<script>
		// ä»main.jsä¸­å¤åˆ¶escapeHtmlå‡½æ•°å’ŒformatFeedbackAsMarkdownå‡½æ•°
		function escapeHtml(str) {
			return str.replace(/&/g, '&amp;')
				.replace(/</g, '&lt;')
				.replace(/>/g, '&gt;')
				.replace(/"/g, '&quot;')
				.replace(/'/g, '&#39;');
		}

		// å°†åé¦ˆå†…å®¹æ ¼å¼åŒ–ä¸ºæŒ‡å®šæ ¼å¼
		function formatFeedbackAsMarkdown(analysis) {
			if (!analysis || !analysis.feedback || analysis.feedback === 'æš‚æ— è¯¦ç»†åé¦ˆ') {
				return '<div class="no-feedback">ğŸ’¡ æš‚æ— è¯¦ç»†åé¦ˆ</div>';
			}

			// è·å–è¯„åˆ†
			const score = analysis.score || 0;

			// æ ¼å¼åŒ–æ”¹è¿›å»ºè®®
			let improvementsText = '';
			if (analysis.improvements && analysis.improvements.length > 0) {
				improvementsText = analysis.improvements.map((improvement, index) =>
					`${index + 1}. ${improvement}`
				).join('\n');
			} else {
				improvementsText = 'æš‚æ— æ”¹è¿›å»ºè®®';
			}

			// æ„å»ºæ ¼å¼åŒ–æ–‡æœ¬
			const formattedText = `
1. è¯„åˆ†ï¼š${score}/100
2. è¯¦ç»†åé¦ˆï¼š${analysis.feedback}
3. æ”¹å»ºå»ºè®®ï¼š
${improvementsText}
`;

			// è½¬ä¹‰HTMLå¹¶ä¿æŒæ¢è¡Œæ ¼å¼
			return `<pre class="feedback-formatted">${escapeHtml(formattedText)}</pre>`;
		}

		// æµ‹è¯•æ•°æ®
		const testData = [
			{
				id: 'test1',
				analysis: {
					score: 85,
					feedback: 'æ‚¨çš„Promptç»“æ„æ¸…æ™°ï¼Œç›®æ ‡æ˜ç¡®ã€‚æŠ€æœ¯è¦æ±‚æè¿°è¾ƒä¸ºå…·ä½“ï¼Œæ¶µç›–äº†ä¸»è¦çš„åŠŸèƒ½éœ€æ±‚ã€‚ä»£ç ç¤ºä¾‹å’Œè¾“å‡ºæ ¼å¼çš„æœŸæœ›æ¯”è¾ƒæ˜ç¡®ã€‚åœ¨æŠ€æœ¯æ ˆé€‰æ‹©æ–¹é¢ç»™å‡ºäº†åˆç†çš„å»ºè®®ã€‚',
					improvements: [
						'å¢åŠ æ›´å…·ä½“çš„æŠ€æœ¯è¦æ±‚å’Œçº¦æŸæ¡ä»¶',
						'æä¾›ç¤ºä¾‹è¾“å…¥è¾“å‡ºä»¥æ˜ç¡®æœŸæœ›ç»“æœ',
						'æŒ‡å®šä»£ç é£æ ¼å’Œæœ€ä½³å®è·µè¦æ±‚'
					]
				}
			},
			{
				id: 'test2',
				analysis: {
					score: 92,
					feedback: 'è¿™æ˜¯ä¸€ä¸ªä¼˜ç§€çš„Promptï¼Œå…·æœ‰æ¸…æ™°çš„ç»“æ„å’Œæ˜ç¡®çš„éœ€æ±‚æè¿°ã€‚',
					improvements: []
				}
			},
			{
				id: 'test3',
				analysis: {
					score: 0,
					feedback: '',
					improvements: []
				}
			}
		];

		// è¿è¡Œæµ‹è¯•
		testData.forEach(test => {
			const container = document.getElementById(test.id);
			container.innerHTML = formatFeedbackAsMarkdown(test.analysis);
		});

		console.log('âœ… æ ¼å¼åŒ–åé¦ˆæµ‹è¯•å®Œæˆ');
	</script>
</body>

</html>