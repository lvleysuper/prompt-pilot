<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Prompt Pilot Debug</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			padding: 20px;
			background: #1e1e1e;
			color: #ffffff;
		}

		.container {
			max-width: 800px;
			margin: 0 auto;
		}

		.status {
			padding: 10px;
			margin: 10px 0;
			border-radius: 5px;
		}

		.success {
			background: #28a745;
		}

		.error {
			background: #dc3545;
		}

		.warning {
			background: #ffc107;
			color: #000;
		}

		button {
			padding: 10px 20px;
			margin: 5px;
			border: none;
			border-radius: 5px;
			background: #007acc;
			color: white;
			cursor: pointer;
		}

		button:hover {
			background: #005a9e;
		}
	</style>
</head>

<body>
	<div class="container">
		<h1>ğŸš€ Prompt Pilot è°ƒè¯•é¢æ¿</h1>

		<div id="status" class="status warning">
			æ­£åœ¨åˆå§‹åŒ–è°ƒè¯•é¢æ¿...
		</div>

		<div>
			<h3>æ‰‹åŠ¨æµ‹è¯•æŒ‰é’®</h3>
			<button onclick="testVSCodeAPI()">æµ‹è¯•VSCode API</button>
			<button onclick="testElements()">æ£€æŸ¥DOMå…ƒç´ </button>
			<button onclick="showAlert()">æ˜¾ç¤ºæµ‹è¯•å¼¹çª—</button>
		</div>

		<div>
			<h3>è°ƒè¯•ä¿¡æ¯</h3>
			<div id="debugInfo">
				<p>é¡µé¢åŠ è½½çŠ¶æ€: <span id="readyState">æ£€æŸ¥ä¸­...</span></p>
				<p>VSCode API: <span id="vscodeAPI">æ£€æŸ¥ä¸­...</span></p>
				<p>å…³é”®å…ƒç´ : <span id="elements">æ£€æŸ¥ä¸­...</span></p>
			</div>
		</div>

		<div>
			<h3>è°ƒè¯•æ—¥å¿—</h3>
			<div id="log"
				style="background: #2d2d2d; padding: 10px; border-radius: 5px; height: 200px; overflow-y: auto; font-family: monospace;">
			</div>
		</div>
	</div>

	<script>
		// è°ƒè¯•æ—¥å¿—å‡½æ•°
		function log(message) {
			const logDiv = document.getElementById('log');
			const time = new Date().toLocaleTimeString();
			logDiv.innerHTML += `[${time}] ${message}<br>`;
			logDiv.scrollTop = logDiv.scrollHeight;
			console.log(message);
		}

		// æ›´æ–°çŠ¶æ€
		function updateStatus(message, type = 'warning') {
			const statusDiv = document.getElementById('status');
			statusDiv.textContent = message;
			statusDiv.className = `status ${type}`;
			log(`çŠ¶æ€æ›´æ–°: ${message}`);
		}

		// æµ‹è¯•VSCode API
		function testVSCodeAPI() {
			try {
				const vscode = acquireVsCodeApi();
				document.getElementById('vscodeAPI').textContent = 'âœ… å¯ç”¨';
				log('âœ… VSCode API æµ‹è¯•æˆåŠŸ');

				// å°è¯•å‘é€æ¶ˆæ¯
				vscode.postMessage({ command: 'test', message: 'Hello from WebView' });
				log('ğŸ“¤ å·²å‘é€æµ‹è¯•æ¶ˆæ¯åˆ°æ‰©å±•');

				updateStatus('VSCode API æµ‹è¯•æˆåŠŸ', 'success');
			} catch (error) {
				document.getElementById('vscodeAPI').textContent = 'âŒ å¤±è´¥: ' + error.message;
				log('âŒ VSCode API æµ‹è¯•å¤±è´¥: ' + error.message);
				updateStatus('VSCode API æµ‹è¯•å¤±è´¥', 'error');
			}
		}

		// æ£€æŸ¥DOMå…ƒç´ 
		function testElements() {
			const requiredElements = ['status', 'debugInfo', 'log'];
			const results = [];

			requiredElements.forEach(id => {
				const element = document.getElementById(id);
				if (element) {
					results.push(`âœ… ${id}`);
				} else {
					results.push(`âŒ ${id}`);
				}
			});

			document.getElementById('elements').innerHTML = results.join('<br>');
			log('DOMå…ƒç´ æ£€æŸ¥å®Œæˆ: ' + results.join(', '));
		}

		// æ˜¾ç¤ºæµ‹è¯•å¼¹çª—
		function showAlert() {
			alert('ğŸ‰ è°ƒè¯•é¢æ¿æ­£å¸¸å·¥ä½œï¼');
			log('ğŸ‰ å¼¹çª—æµ‹è¯•æˆåŠŸ');
		}

		// é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
		window.addEventListener('load', function () {
			log('ğŸš€ è°ƒè¯•é¢æ¿å¼€å§‹åˆå§‹åŒ–');

			// æ£€æŸ¥é¡µé¢çŠ¶æ€
			document.getElementById('readyState').textContent = document.readyState;

			// è‡ªåŠ¨æ‰§è¡Œæµ‹è¯•
			setTimeout(() => {
				testVSCodeAPI();
				testElements();
				updateStatus('è°ƒè¯•é¢æ¿åˆå§‹åŒ–å®Œæˆ', 'success');
				log('ğŸ‰ æ‰€æœ‰åˆå§‹åŒ–æµ‹è¯•å®Œæˆ');
			}, 1000);
		});

		// ç›‘å¬æ¥è‡ªæ‰©å±•çš„æ¶ˆæ¯
		window.addEventListener('message', function (event) {
			const message = event.data;
			log('ğŸ“¨ æ”¶åˆ°æ‰©å±•æ¶ˆæ¯: ' + JSON.stringify(message));
		});

		// å…¨å±€é”™è¯¯å¤„ç†
		window.addEventListener('error', function (e) {
			log('âŒ å…¨å±€é”™è¯¯: ' + e.error?.message || 'æœªçŸ¥é”™è¯¯');
			updateStatus('å‘ç”ŸJavaScripté”™è¯¯', 'error');
		});
	</script>
</body>

</html>