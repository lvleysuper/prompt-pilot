<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Promptç”ŸæˆåŠŸèƒ½æµ‹è¯•</title>
	<style>
		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			max-width: 800px;
			margin: 0 auto;
			padding: 20px;
			line-height: 1.6;
			background: #1e1e1e;
			color: #cccccc;
		}

		.test-section {
			background: #2d2d30;
			border: 1px solid #464647;
			border-radius: 8px;
			padding: 20px;
			margin: 20px 0;
		}

		.btn {
			background: #0e639c;
			color: white;
			border: none;
			padding: 10px 16px;
			border-radius: 4px;
			cursor: pointer;
			margin: 5px;
			font-size: 14px;
		}

		.btn:hover {
			background: #1177bb;
		}

		.btn.secondary {
			background: #5a5a5a;
		}

		.btn.secondary:hover {
			background: #6a6a6a;
		}

		.status {
			padding: 10px;
			border-radius: 4px;
			margin: 10px 0;
			display: none;
		}

		.status.success {
			background: #365c03;
			border: 1px solid #46760a;
			color: #cccccc;
		}

		.status.error {
			background: #5a1d1d;
			border: 1px solid #f85149;
			color: #cccccc;
		}

		pre {
			background: #1e1e1e;
			border: 1px solid #464647;
			border-radius: 4px;
			padding: 15px;
			overflow-x: auto;
			white-space: pre-wrap;
		}

		textarea {
			width: 100%;
			height: 100px;
			background: #1e1e1e;
			border: 1px solid #464647;
			color: #cccccc;
			padding: 10px;
			border-radius: 4px;
			resize: vertical;
		}

		.result-actions {
			margin-top: 15px;
			display: flex;
			gap: 10px;
		}

		#generatedPromptResult {
			margin-top: 20px;
			display: none;
		}
	</style>
</head>

<body>
	<h1>ğŸ§ª Promptç”ŸæˆåŠŸèƒ½æµ‹è¯•</h1>

	<div class="test-section">
		<h3>ğŸ“ ä»»åŠ¡æè¿°è¾“å…¥</h3>
		<p>åœ¨ä¸‹é¢è¾“å…¥æ‚¨æƒ³è¦ç”ŸæˆPromptçš„ä»»åŠ¡æè¿°ï¼š</p>

		<textarea id="taskDescription" placeholder="ä¾‹å¦‚ï¼šæˆ‘æƒ³å†™ä¸€ä¸ªè®¡ç®—å™¨åº”ç”¨ï¼Œè¦æ±‚æ”¯æŒåŸºæœ¬çš„å››åˆ™è¿ç®—...">æˆ‘æƒ³å†™ä¸€ä¸ªåœ¨çº¿è®¡ç®—å™¨ï¼Œè¦æ±‚ï¼š
1. æ”¯æŒåŸºæœ¬çš„åŠ å‡ä¹˜é™¤è¿ç®—
2. æœ‰æ¸…æ™°çš„ç”¨æˆ·ç•Œé¢
3. æ”¯æŒé”®ç›˜è¾“å…¥
4. åŒ…å«æ¸…é›¶å’Œåˆ é™¤åŠŸèƒ½
5. ä½¿ç”¨HTMLã€CSSã€JavaScriptå®ç°</textarea>

		<div style="margin-top: 10px;">
			<button class="btn" onclick="testGeneratePrompt()">ğŸš€ æµ‹è¯•ç”ŸæˆPrompt</button>
			<button class="btn secondary" onclick="testWithComplexPrompt()">ğŸ§® æµ‹è¯•å¤æ‚å†…å®¹</button>
			<button class="btn secondary" onclick="testWithSpecialChars()">ğŸ”¤ æµ‹è¯•ç‰¹æ®Šå­—ç¬¦</button>
		</div>

		<div id="status" class="status"></div>
	</div>

	<div id="generatedPromptResult" class="test-section">
		<!-- ç”Ÿæˆçš„ç»“æœä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ -->
	</div>

	<div class="test-section">
		<h3>ğŸ”§ åŠŸèƒ½éªŒè¯æ¸…å•</h3>
		<ul>
			<li id="check1">âœ… èƒ½å¤Ÿè¾“å…¥ä»»åŠ¡æè¿°</li>
			<li id="check2">â³ èƒ½å¤Ÿç”ŸæˆPromptï¼ˆå¾…æµ‹è¯•ï¼‰</li>
			<li id="check3">â³ å¤åˆ¶åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼ˆå¾…æµ‹è¯•ï¼‰</li>
			<li id="check4">â³ ä½¿ç”¨åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼ˆå¾…æµ‹è¯•ï¼‰</li>
			<li id="check5">â³ ç‰¹æ®Šå­—ç¬¦å¤„ç†æ­£ç¡®ï¼ˆå¾…æµ‹è¯•ï¼‰</li>
		</ul>
	</div>

	<script>
		// æ¨¡æ‹Ÿå…ƒç´ å¯¹è±¡
		const elements = {
			generatedPromptResult: document.getElementById('generatedPromptResult')
		};

		// æ¨¡æ‹Ÿç»Ÿè®¡æ•°æ®
		let promptUsageStats = {
			generateCount: 0,
			copyCount: 0,
			useCount: 0,
			optimizeCount: 0
		};

		// æ¨¡æ‹Ÿvscodeæ¥å£
		const vscode = {
			postMessage: function (message) {
				console.log('ğŸ“¤ æ¨¡æ‹Ÿå‘é€æ¶ˆæ¯åˆ°VSCode:', message);

				// æ¨¡æ‹Ÿåç«¯å“åº”
				setTimeout(() => {
					if (message.command === 'generatePrompt') {
						simulatePromptGenerated(message.task);
					}
				}, 1500);
			}
		};

		// æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
		function showStatus(message, type) {
			const statusEl = document.getElementById('status');
			statusEl.textContent = message;
			statusEl.className = `status ${type}`;
			statusEl.style.display = 'block';

			setTimeout(() => {
				statusEl.style.display = 'none';
			}, 3000);
		}

		function showConfigStatus(message, type) {
			showStatus(message, type);
		}

		function showLoading(message) {
			showStatus(message, 'info');
		}

		function hideLoading() {
			document.getElementById('status').style.display = 'none';
		}

		// æ¨¡æ‹ŸPromptç”Ÿæˆå“åº”
		function simulatePromptGenerated(task) {
			let mockPrompt = '';

			if (task.includes('è®¡ç®—å™¨') || task.includes('calculator')) {
				mockPrompt = `è¯·ä½ ä½œä¸ºä¸€åä¸“ä¸šçš„å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œåˆ›å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è®¡ç®—å™¨åº”ç”¨ã€‚

## åŠŸèƒ½è¦æ±‚ï¼š
1. åŸºæœ¬è¿ç®—ï¼šåŠ æ³•(+)ã€å‡æ³•(-)ã€ä¹˜æ³•(Ã—)ã€é™¤æ³•(Ã·)
2. é«˜çº§åŠŸèƒ½ï¼šæ¸…é›¶(C)ã€åˆ é™¤(DEL)ã€å°æ•°ç‚¹æ”¯æŒ
3. ç•Œé¢è®¾è®¡ï¼šç°ä»£åŒ–UIï¼Œå“åº”å¼å¸ƒå±€
4. äº¤äº’ä½“éªŒï¼šé”®ç›˜æ”¯æŒã€é”™è¯¯å¤„ç†

## æŠ€æœ¯è§„èŒƒï¼š
- ä½¿ç”¨HTML5ã€CSS3ã€JavaScript
- é‡‡ç”¨Gridå¸ƒå±€è®¾è®¡æŒ‰é’®
- å®ç°é”®ç›˜å¿«æ·é”®æ“ä½œ
- æ·»åŠ åŠ¨ç”»æ•ˆæœå’Œè§†è§‰åé¦ˆ

## è¾“å‡ºè¦æ±‚ï¼š
è¯·æä¾›å®Œæ•´çš„HTMLæ–‡ä»¶ï¼ŒåŒ…å«å†…è”CSSå’ŒJavaScriptï¼Œç¡®ä¿å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚

## ç‰¹æ®Šå­—ç¬¦æµ‹è¯•ï¼š
è¿™é‡ŒåŒ…å«"åŒå¼•å·"ã€'å•å¼•å·'ã€æ¢è¡Œç¬¦
ä»¥åŠå…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼š&ã€<ã€>ã€$ã€%ã€#
ä»£ç ç¤ºä¾‹ï¼š
\`\`\`javascript
function calculate(a, b) {
    return a + b;
}
\`\`\``;
			} else {
				mockPrompt = `è¯·ä½ ä½œä¸ºä¸€åä¸“ä¸šçš„è½¯ä»¶å¼€å‘å·¥ç¨‹å¸ˆï¼Œå®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š

## ä»»åŠ¡æè¿°ï¼š
${task}

## å®ç°è¦æ±‚ï¼š
1. åŠŸèƒ½å®Œæ•´æ€§ï¼šç¡®ä¿æ»¡è¶³æ‰€æœ‰åŸºæœ¬éœ€æ±‚
2. ä»£ç è´¨é‡ï¼šéµå¾ªæœ€ä½³å®è·µå’Œç¼–ç è§„èŒƒ
3. é”™è¯¯å¤„ç†ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œè¾¹ç•Œæƒ…å†µè€ƒè™‘
4. ç”¨æˆ·ä½“éªŒï¼šç›´è§‚æ˜“ç”¨çš„äº¤äº’è®¾è®¡

## æŠ€æœ¯è§„èŒƒï¼š
- é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ ˆå’Œå·¥å…·
- ç¼–å†™æ¸…æ™°çš„ä»£ç æ³¨é‡Š
- éµå¾ªSOLIDè®¾è®¡åŸåˆ™
- è€ƒè™‘å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§

## è¾“å‡ºè¦æ±‚ï¼š
è¯·æä¾›å®Œæ•´çš„å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ ¸å¿ƒä»£ç ã€ä½¿ç”¨è¯´æ˜å’Œå…³é”®æŠ€æœ¯ç‚¹è§£æã€‚ç¡®ä¿ä»£ç å¯ä»¥ç›´æ¥è¿è¡Œå¹¶è¾¾åˆ°é¢„æœŸæ•ˆæœã€‚`;
			}

			handlePromptGenerated(mockPrompt);
			updateChecklist('check2', true);
		}

		// === ä»¥ä¸‹æ˜¯ä¿®å¤åçš„æ ¸å¿ƒå‡½æ•° ===

		// å®‰å…¨åœ°è½¬ä¹‰HTMLå†…å®¹
		const escapeHtml = (str) => {
			return str.replace(/&/g, '&amp;')
				.replace(/</g, '&lt;')
				.replace(/>/g, '&gt;')
				.replace(/"/g, '&quot;')
				.replace(/'/g, '&#39;');
		};

		// å¤„ç†Promptç”Ÿæˆç»“æœï¼ˆä¿®å¤åçš„ç‰ˆæœ¬ï¼‰
		function handlePromptGenerated(prompt) {
			hideLoading();

			if (!elements.generatedPromptResult) return;

			// åˆ›å»ºæŒ‰é’®å…ƒç´ ï¼Œé¿å…å­—ç¬¦ä¸²è½¬ä¹‰é—®é¢˜
			const resultContainer = document.createElement('div');
			resultContainer.innerHTML = `
                <h4>ç”Ÿæˆçš„ Prompt</h4>
                <pre>${escapeHtml(prompt)}</pre>
                <div class="result-actions" id="promptActions"></div>
            `;

			// åˆ›å»ºå¤åˆ¶æŒ‰é’®
			const copyButton = document.createElement('button');
			copyButton.className = 'btn secondary';
			copyButton.innerHTML = 'ğŸ“‹ å¤åˆ¶';
			copyButton.addEventListener('click', () => {
				copyPrompt(prompt);
				updateChecklist('check3', true);
			});

			// åˆ›å»ºä½¿ç”¨æŒ‰é’®
			const useButton = document.createElement('button');
			useButton.className = 'btn primary';
			useButton.innerHTML = 'âœ… ä½¿ç”¨æ­¤ Prompt';
			useButton.addEventListener('click', () => {
				usePrompt(prompt);
				updateChecklist('check4', true);
			});

			// åˆ›å»ºåˆ†ææŒ‰é’®
			const analyzeButton = document.createElement('button');
			analyzeButton.className = 'btn secondary';
			analyzeButton.innerHTML = 'ğŸ“Š æµ‹è¯•åˆ†æåŠŸèƒ½';
			analyzeButton.addEventListener('click', () => {
				testPromptAnalysis(prompt);
			});

			// åˆ›å»ºä»£ç ç”ŸæˆæŒ‰é’®
			const generateCodeButton = document.createElement('button');
			generateCodeButton.className = 'btn secondary';
			generateCodeButton.innerHTML = 'ğŸš€ æµ‹è¯•ä»£ç ç”Ÿæˆ';
			generateCodeButton.addEventListener('click', () => {
				testCodeGeneration(prompt);
			});

			// æ·»åŠ æŒ‰é’®åˆ°å®¹å™¨
			const actionsContainer = resultContainer.querySelector('#promptActions');
			actionsContainer.appendChild(copyButton);
			actionsContainer.appendChild(useButton);
			actionsContainer.appendChild(analyzeButton);
			actionsContainer.appendChild(generateCodeButton);

			// æ›´æ–°æ˜¾ç¤º
			elements.generatedPromptResult.innerHTML = '';
			elements.generatedPromptResult.appendChild(resultContainer);
			elements.generatedPromptResult.style.display = 'block';
		}

		// æµ‹è¯•Promptåˆ†æåŠŸèƒ½
		function testPromptAnalysis(prompt) {
			showStatus('æ­£åœ¨æµ‹è¯•Promptåˆ†æåŠŸèƒ½...', 'info');

			// æ¨¡æ‹Ÿåˆ†æç»“æœ
			setTimeout(() => {
				const score = Math.floor(Math.random() * 30) + 65; // 65-95åˆ†

				// æ ¹æ®åˆ†æ•°ç”Ÿæˆå¯¹åº”çš„åé¦ˆå†…å®¹
				let feedback = '';
				if (score >= 85) {
					feedback = `æ‚¨çš„Promptè¡¨ç°ä¼˜ç§€ï¼ˆ${score}åˆ†ï¼‰ï¼å…·æœ‰æ¸…æ™°çš„ç»“æ„å’Œæ˜ç¡®çš„éœ€æ±‚æè¿°ï¼ŒæŠ€æœ¯è¦æ±‚å…·ä½“ï¼ŒåŒ…å«äº†å®Œæ•´çš„åŠŸèƒ½éœ€æ±‚å’ŒæŠ€æœ¯æ ˆé€‰æ‹©ã€‚`;
				} else if (score >= 70) {
					feedback = `æ‚¨çš„Promptè´¨é‡è‰¯å¥½ï¼ˆ${score}åˆ†ï¼‰ã€‚åŒ…å«äº†åŸºæœ¬çš„é—®é¢˜æè¿°å’Œä¸»è¦éœ€æ±‚ï¼Œåœ¨æŠ€æœ¯ç»†èŠ‚å’Œé™åˆ¶æ¡ä»¶æ–¹é¢å¯ä»¥è¿›ä¸€æ­¥å®Œå–„ã€‚`;
				} else {
					feedback = `æ‚¨çš„Promptéœ€è¦æ”¹è¿›ï¼ˆ${score}åˆ†ï¼‰ã€‚è™½ç„¶åŒ…å«äº†åŸºæœ¬çš„é—®é¢˜æè¿°ï¼Œä½†åœ¨æ˜ç¡®æ€§ã€å®Œæ•´æ€§å’ŒæŠ€æœ¯è¦æ±‚æ–¹é¢è¿˜æœ‰æå‡ç©ºé—´ã€‚`;
				}

				const mockAnalysis = {
					score: score,
					feedback: feedback,
					improvements: [
						'å¢åŠ æ›´å…·ä½“çš„æŠ€æœ¯è¦æ±‚å’Œçº¦æŸæ¡ä»¶',
						'æä¾›ç¤ºä¾‹è¾“å…¥è¾“å‡ºä»¥æ˜ç¡®æœŸæœ›',
						'æŒ‡å®šä»£ç é£æ ¼å’Œæœ€ä½³å®è·µè¦æ±‚',
						'æ·»åŠ æ€§èƒ½å’Œè¾¹ç•Œæƒ…å†µè€ƒè™‘'
					]
				};
				handlePromptAnalyzed(mockAnalysis);
			}, 1000);
		}

		// æµ‹è¯•ä»£ç ç”ŸæˆåŠŸèƒ½
		function testCodeGeneration(prompt) {
			showStatus('æ­£åœ¨æµ‹è¯•ä»£ç ç”ŸæˆåŠŸèƒ½...', 'info');

			// æ¨¡æ‹Ÿä»£ç ç”Ÿæˆç»“æœ
			setTimeout(() => {
				const mockCode = `// æ¨¡æ‹Ÿç”Ÿæˆçš„TypeScriptä»£ç 
class Calculator {
    private result: number = 0;

    /**
     * æ‰§è¡ŒåŠ æ³•è¿ç®—
     * @param a æ“ä½œæ•°A
     * @param b æ“ä½œæ•°B
     * @returns åŠ æ³•ç»“æœ
     */
    add(a: number, b: number): number {
        try {
            this.result = a + b;
            return this.result;
        } catch (error) {
            throw new Error('åŠ æ³•è¿ç®—å¤±è´¥: ' + error.message);
        }
    }

    /**
     * è·å–å½“å‰ç»“æœ
     */
    getResult(): number {
        return this.result;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const calc = new Calculator();
console.log(calc.add(2, 3)); // è¾“å‡º: 5`;

				const mockResponse = {
					success: true,
					generatedCode: mockCode,
					explanation: 'è¿™æ˜¯ä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨ç±»å®ç°ï¼ŒåŒ…å«äº†å®Œæ•´çš„TypeScriptç±»å‹æ³¨è§£ã€é”™è¯¯å¤„ç†å’Œè¯¦ç»†æ³¨é‡Šã€‚ä»£ç éµå¾ªäº†é¢å‘å¯¹è±¡çš„è®¾è®¡åŸåˆ™ï¼Œå…·æœ‰è‰¯å¥½çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚'
				};
				handleCodeGenerated(mockResponse);
			}, 1200);
		}

		// å¤åˆ¶Promptåˆ°å‰ªè´´æ¿
		function copyPrompt(prompt) {
			console.log('ğŸ”„ æ­£åœ¨å¤åˆ¶Promptåˆ°å‰ªè´´æ¿...');

			// æ›´æ–°ç»Ÿè®¡
			promptUsageStats.copyCount++;

			// å°è¯•ä½¿ç”¨ç°ä»£APIå¤åˆ¶
			if (navigator.clipboard && window.isSecureContext) {
				navigator.clipboard.writeText(prompt).then(() => {
					console.log('âœ… Promptå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
					showConfigStatus('ğŸ“‹ Promptå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
				}).catch(err => {
					console.error('âŒ å¤åˆ¶å¤±è´¥:', err);
					fallbackCopy(prompt);
				});
			} else {
				// é™çº§æ–¹æ¡ˆ
				fallbackCopy(prompt);
			}
		}

		// é™çº§å¤åˆ¶æ–¹æ¡ˆ
		function fallbackCopy(prompt) {
			try {
				// åˆ›å»ºä¸´æ—¶æ–‡æœ¬åŒºåŸŸ
				const textArea = document.createElement('textarea');
				textArea.value = prompt;
				textArea.style.position = 'fixed';
				textArea.style.left = '-999999px';
				textArea.style.top = '-999999px';
				document.body.appendChild(textArea);
				textArea.focus();
				textArea.select();

				const successful = document.execCommand('copy');
				document.body.removeChild(textArea);

				if (successful) {
					console.log('âœ… Promptå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆé™çº§æ–¹æ¡ˆï¼‰');
					showConfigStatus('ğŸ“‹ Promptå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆé™çº§æ–¹æ¡ˆï¼‰', 'success');
				} else {
					throw new Error('execCommand failed');
				}
			} catch (err) {
				console.error('âŒ é™çº§å¤åˆ¶ä¹Ÿå¤±è´¥:', err);
				showConfigStatus('âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶å†…å®¹', 'error');
			}
		}

		// ä½¿ç”¨ç”Ÿæˆçš„Prompt
		function usePrompt(prompt) {
			console.log('ğŸš€ ä½¿ç”¨ç”Ÿæˆçš„Prompt...');

			// æ›´æ–°ç»Ÿè®¡
			promptUsageStats.useCount++;

			// å¤åˆ¶å†…å®¹åˆ°å‰ªè´´æ¿
			copyPrompt(prompt);

			// å‘é€ä½¿ç”¨ç»Ÿè®¡
			sendUsageStats('use');

			// æ˜¾ç¤ºæ¥çº³ç¡®è®¤
			showConfigStatus('âœ… Promptå·²æ¥çº³å¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');

			// æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
			const ratio = getUsageRatio();
			console.log(`ğŸ“Š æ¥çº³ç»Ÿè®¡: æ¥çº³æ¬¡æ•° ${ratio.totalUsed}, æ¥çº³ç‡ ${ratio.useRatio}%`);
		}

		// å‘é€ä½¿ç”¨ç»Ÿè®¡æ•°æ®
		function sendUsageStats(action) {
			try {
				// å‘é€ç»Ÿè®¡æ•°æ®åˆ°åç«¯
				vscode.postMessage({
					command: 'recordPromptUsage',
					action: action,
					stats: promptUsageStats,
					timestamp: new Date().toISOString()
				});
				console.log(`ğŸ“Š ç»Ÿè®¡æ•°æ®å·²å‘é€: ${action}`, promptUsageStats);
				// æ›´æ–°æ˜¾ç¤º
				displayUsageStatistics();
			} catch (error) {
				console.error('âŒ å‘é€ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
			}
		}

		// è·å–ä½¿ç”¨ç»Ÿè®¡å æ¯”
		function getUsageRatio() {
			const totalGenerated = promptUsageStats.generateCount + promptUsageStats.optimizeCount;
			const totalUsed = promptUsageStats.useCount;
			const totalCopied = promptUsageStats.copyCount;

			// è®¡ç®—æ¥çº³ç‡ï¼ˆä½¿ç”¨æ¬¡æ•° / ç”Ÿæˆæ¬¡æ•°ï¼‰
			const acceptanceRate = totalGenerated === 0 ? 0 : Math.round((totalUsed / totalGenerated) * 100);
			// è®¡ç®—å¤åˆ¶ç‡ï¼ˆå¤åˆ¶æ¬¡æ•° / ç”Ÿæˆæ¬¡æ•°ï¼‰
			const copyRate = totalGenerated === 0 ? 0 : Math.round((totalCopied / totalGenerated) * 100);

			return {
				useRatio: acceptanceRate,        // æ¥çº³ç‡
				copyRatio: copyRate,             // å¤åˆ¶ç‡
				totalGenerated: totalGenerated,  // æ€»ç”Ÿæˆæ¬¡æ•°
				totalUsed: totalUsed,            // æ€»æ¥çº³æ¬¡æ•°
				totalCopied: totalCopied,        // æ€»å¤åˆ¶æ¬¡æ•°
				acceptanceRate: acceptanceRate   // æ¥çº³ç‡ï¼ˆåˆ«åï¼‰
			};
		}

		// æ˜¾ç¤ºä½¿ç”¨ç»Ÿè®¡ä¿¡æ¯
		function displayUsageStatistics() {
			const ratio = getUsageRatio();
			console.log('ğŸ“Š å½“å‰ä½¿ç”¨ç»Ÿè®¡:', {
				ç”Ÿæˆæ¬¡æ•°: ratio.totalGenerated,
				æ¥çº³æ¬¡æ•°: ratio.totalUsed,
				å¤åˆ¶æ¬¡æ•°: ratio.totalCopied,
				æ¥çº³ç‡: ratio.acceptanceRate + '%',
				å¤åˆ¶ç‡: ratio.copyRate + '%'
			});

			// æ›´æ–°ç»Ÿè®¡æ˜¾ç¤ºå…ƒç´ 
			const statsElement = document.getElementById('promptUsageStats');
			if (statsElement) {
				statsElement.innerHTML = `
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">ç”Ÿæˆæ¬¡æ•°</span>
                            <span class="stat-value">${ratio.totalGenerated}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">æ¥çº³æ¬¡æ•°</span>
                            <span class="stat-value">${ratio.totalUsed}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">å¤åˆ¶æ¬¡æ•°</span>
                            <span class="stat-value">${ratio.totalCopied}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">æ¥çº³ç‡</span>
                            <span class="stat-value">${ratio.acceptanceRate}%</span>
                        </div>
                    </div>
                `;
			}
		}

		// æµ‹è¯•å‡½æ•°
		function testGeneratePrompt() {
			const task = document.getElementById('taskDescription').value.trim();
			if (!task) {
				showStatus('âŒ è¯·å…ˆè¾“å…¥ä»»åŠ¡æè¿°', 'error');
				return;
			}

			showLoading('æ­£åœ¨ç”ŸæˆPrompt...');

			// æ¨¡æ‹Ÿå‘é€åˆ°åç«¯
			vscode.postMessage({
				command: 'generatePrompt',
				task: task
			});
		}

		function testWithComplexPrompt() {
			document.getElementById('taskDescription').value = `æˆ‘éœ€è¦ä¸€ä¸ªå¤æ‚çš„Webåº”ç”¨ï¼š
1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ˆç™»å½•/æ³¨å†Œï¼‰
2. æ•°æ®å¯è§†åŒ–ä»ªè¡¨æ¿
3. å®æ—¶èŠå¤©åŠŸèƒ½
4. æ–‡ä»¶ä¸Šä¼ å’Œç®¡ç†
5. å“åº”å¼è®¾è®¡
6. APIæ¥å£è®¾è®¡
åŒ…å«"ç‰¹æ®Šå­—ç¬¦"ï¼šåŒå¼•å·ã€'å•å¼•å·'ã€&ç¬¦å·ã€<æ ‡ç­¾>ç­‰
ä»£ç ç¤ºä¾‹ï¼š
function test() {
    console.log("Hello 'World'!");
    return a < b && c > d;
}`;
			testGeneratePrompt();
		}

		function testWithSpecialChars() {
			document.getElementById('taskDescription').value = `æµ‹è¯•ç‰¹æ®Šå­—ç¬¦å¤„ç†ï¼š
"åŒå¼•å·å†…å®¹"
'å•å¼•å·å†…å®¹'
HTMLæ ‡ç­¾<div>å†…å®¹</div>
JavaScriptä»£ç ï¼š
var msg = "Hello 'World'!";
if (a < b && c > d) {
    console.log('æˆåŠŸå¤„ç†ç‰¹æ®Šå­—ç¬¦');
}
æ¢è¡Œç¬¦
å’Œåˆ¶è¡¨ç¬¦æµ‹è¯•`;
			testGeneratePrompt();
			updateChecklist('check5', true);
		}

		// æ›´æ–°éªŒè¯æ¸…å•
		function updateChecklist(checkId, success) {
			const element = document.getElementById(checkId);
			if (success) {
				element.innerHTML = element.innerHTML.replace('â³', 'âœ…');
			} else {
				element.innerHTML = element.innerHTML.replace('â³', 'âŒ');
			}
		}

		// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
		document.addEventListener('DOMContentLoaded', function () {
			console.log('ğŸ§ª æµ‹è¯•é¡µé¢å·²åŠ è½½ï¼Œå‡†å¤‡å¼€å§‹æµ‹è¯•...');
		});

		// å¤„ç†Promptåˆ†æç»“æœ
		function handlePromptAnalyzed(analysis) {
			hideLoading();

			// å®‰å…¨åœ°è½¬ä¹‰HTMLå†…å®¹
			const escapeHtml = (str) => {
				return str.replace(/&/g, '&amp;')
					.replace(/</g, '&lt;')
					.replace(/>/g, '&gt;')
					.replace(/"/g, '&quot;')
					.replace(/'/g, '&#39;');
			};

			// åˆ›å»ºç»“æ„åŒ–çš„åˆ†æç»“æœ
			const resultContainer = document.createElement('div');
			resultContainer.className = 'prompt-analysis-result';

			// åˆ†æ•°ç­‰çº§åˆ¤æ–­
			const score = analysis.score || 0;
			let scoreLevel = 'low';
			let scoreIcon = 'ğŸ”´';
			let scoreText = 'éœ€è¦æ”¹è¿›';

			if (score >= 80) {
				scoreLevel = 'high';
				scoreIcon = 'ğŸŸ¢';
				scoreText = 'ä¼˜ç§€';
			} else if (score >= 60) {
				scoreLevel = 'medium';
				scoreIcon = 'ğŸŸ¡';
				scoreText = 'è‰¯å¥½';
			}

			// æ·»åŠ åˆ†æç»“æœçš„HTMLç»“æ„
			resultContainer.innerHTML = `
				<div class="analysis-header">
					<h4><i class="icon">ğŸ“Š</i> Prompt è´¨é‡åˆ†ææŠ¥å‘Š</h4>
					<div class="analysis-timestamp">ğŸ•°ï¸ ${new Date().toLocaleString()}</div>
				</div>
				<div class="analysis-score-card">
					<div class="score-circle ${scoreLevel}">
						<div class="score-number">${score}</div>
						<div class="score-total">/100</div>
					</div>
					<div class="score-details">
						<div class="score-level">${scoreIcon} ${scoreText}</div>
						<div class="score-description">ç»¼åˆè¯„ä¼°ç»“æœ</div>
					</div>
				</div>
				<div class="analysis-sections">
					<div class="analysis-section">
						<div class="section-header">
							<i class="icon">ğŸ“</i>
							<h5>è¯¦ç»†åé¦ˆ</h5>
						</div>
						<div class="section-content">
							${escapeHtml(analysis.feedback || 'åˆ†æå®Œæˆ')}
						</div>
					</div>
				</div>
			`;

			// æ˜¾ç¤ºç»“æœ
			const analysisContainer = document.getElementById('promptAnalysisResult') || document.body;
			analysisContainer.appendChild(resultContainer);
			showStatus('âœ… Promptåˆ†æå®Œæˆï¼', 'success');
		}

		// å¤„ç†ä»£ç ç”Ÿæˆç»“æœ
		function handleCodeGenerated(response) {
			hideLoading();

			if (!response.success) {
				showStatus('â— ä»£ç ç”Ÿæˆå¤±è´¥: ' + (response.error || 'æœªçŸ¥é”™è¯¯'), 'error');
				return;
			}

			const generatedCode = response.generatedCode;

			// åˆ›å»ºç»“æ„åŒ–çš„ä»£ç ç”Ÿæˆç»“æœ
			const resultContainer = document.createElement('div');
			resultContainer.className = 'code-generation-result';

			// åˆ†æä»£ç ç»Ÿè®¡ä¿¡æ¯
			const codeLines = generatedCode.split('\n').length;
			const codeSize = new Blob([generatedCode]).size;
			const functions = (generatedCode.match(/function\s+\w+|\w+\s*=\s*\([^)]*\)\s*=>/g) || []).length;
			const classes = (generatedCode.match(/class\s+\w+/g) || []).length;

			// æ·»åŠ ä»£ç ç»“æœçš„HTMLç»“æ„
			resultContainer.innerHTML = `
				<div class="code-header">
					<h4><i class="icon">ğŸš€</i> ä»£ç ç”Ÿæˆå®Œæˆ</h4>
					<div class="code-meta">
						<span>ğŸ•°ï¸ ${new Date().toLocaleTimeString()}</span>
						<span>ğŸ“ ${codeLines} è¡Œ</span>
					</div>
				</div>
				<div class="code-content">
					<div class="code-block">
						<div class="code-block-header">
							<span class="code-language">TypeScript</span>
							<button class="copy-code-btn" onclick="copyPrompt('${generatedCode.replace(/'/g, "\\'")}')">ğŸ“‹ å¤åˆ¶ä»£ç </button>
						</div>
						<pre>${escapeHtml(generatedCode)}</pre>
					</div>
				</div>
			`;

			// æ˜¾ç¤ºç»“æœ
			const codeContainer = document.getElementById('codeGenerationResult') || document.body;
			codeContainer.appendChild(resultContainer);
			showStatus('âœ… ä»£ç ç”Ÿæˆå®Œæˆï¼', 'success');
		}
	</script>
</body>

</html>